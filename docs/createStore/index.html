<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Creating Stores</title>
  <meta name="description" content="A library for managing data within JavaScript applications. Alt is a pure flux implementation that is small, terse, well tested, extremely flexible, and forward thinking.
">

  <link rel="canonical" href="https://goatslacker.github.io/alt/docs/createStore/">
  <link rel="alternate" type="application/rss+xml" title="Alt" href="https://goatslacker.github.io/alt/feed.xml" />

  <link type="text/css" rel="stylesheet" href="/alt/assets/lotus.min.css" />
  <link type="text/css" rel="stylesheet" href="/alt/assets/prism.min.css" />
  <link type="text/css" rel="stylesheet" href="/alt/assets/styles.css" />
</head>


  <body>

    
<header class="sp-horiz-lg">
  <div class="row">
    <div class="col c2">
      <a href="/alt/"><img class="logo" src="/alt/assets/alt.png" alt="Alt" width="40" /></a>
    </div>
    <div class="col c10">
      <nav class="txt-light txt-right pure-menu pure-menu-horizontal">
        <ul class="pure-menu-list">
          <li class="pure-menu-item">
            <a href="/alt/guide/" class="pure-menu-link">Getting Started</a>
          </li>
          <li class="pure-menu-item pure-menu-has-children pure-menu-allow-hover">
            <a href="/alt/docs/" id="menuLink1" class="pure-menu-link">API Documentation</a>
            <ul class="pure-menu-children">
              
              <li class="pure-menu-item">
                <a href="/alt/docs/createActions" class="pure-menu-link">Creating Actions</a>
              </li>
              
              <li class="pure-menu-item">
                <a href="/alt/docs/actions" class="pure-menu-link">Actions</a>
              </li>
              
              <li class="pure-menu-item">
                <a href="/alt/docs/createStore" class="pure-menu-link">Creating Stores</a>
              </li>
              
              <li class="pure-menu-item">
                <a href="/alt/docs/stores" class="pure-menu-link">Stores</a>
              </li>
              
              <li class="pure-menu-item">
                <a href="/alt/docs/lifecycleListeners" class="pure-menu-link">Lifecycle Listeners</a>
              </li>
              
              <li class="pure-menu-item">
                <a href="/alt/docs/bootstrap" class="pure-menu-link">Bootstrap</a>
              </li>
              
              <li class="pure-menu-item">
                <a href="/alt/docs/takeSnapshot" class="pure-menu-link">Take Snapshot</a>
              </li>
              
              <li class="pure-menu-item">
                <a href="/alt/docs/flush" class="pure-menu-link">Flush</a>
              </li>
              
              <li class="pure-menu-item">
                <a href="/alt/docs/recycle" class="pure-menu-link">Recycle</a>
              </li>
              
              <li class="pure-menu-item">
                <a href="/alt/docs/rollback" class="pure-menu-link">Rollback</a>
              </li>
              
              <li class="pure-menu-item">
                <a href="/alt/docs/altInstances" class="pure-menu-link">Alt Instances</a>
              </li>
              
            </ul>
          </li>
          <li class="pure-menu-item">
            <a href="/alt/blog/">Blog</a>
          </li>
          <li class="pure-menu-item">
            <a href="https://gitter.im/goatslacker/alt">Support</a>
          </li>
          <li class="pure-menu-item">
            <a href="https://github.com/goatslacker/alt">GitHub</a>
          </li>
        </ul>
      </nav>
    </div>
  </div>
</header>


    <div class="main sp-vert-md sp-horiz-lg">
      <div class="row">
        <div class="col c2">
          <ul class="sidenav">
  
  <li>
    <a href="/alt/docs/createActions">Creating Actions</a>
  </li>
  
  <li>
    <a href="/alt/docs/actions">Actions</a>
  </li>
  
  <li>
    <a href="/alt/docs/createStore">Creating Stores</a>
  </li>
  
  <li>
    <a href="/alt/docs/stores">Stores</a>
  </li>
  
  <li>
    <a href="/alt/docs/lifecycleListeners">Lifecycle Listeners</a>
  </li>
  
  <li>
    <a href="/alt/docs/bootstrap">Bootstrap</a>
  </li>
  
  <li>
    <a href="/alt/docs/takeSnapshot">Take Snapshot</a>
  </li>
  
  <li>
    <a href="/alt/docs/flush">Flush</a>
  </li>
  
  <li>
    <a href="/alt/docs/recycle">Recycle</a>
  </li>
  
  <li>
    <a href="/alt/docs/rollback">Rollback</a>
  </li>
  
  <li>
    <a href="/alt/docs/altInstances">Alt Instances</a>
  </li>
  
</ul>

        </div>
        <div class="col c10">
          <div class="sp-horiz-md">
            <h1 id="createstore">createStore</h1>

<blockquote>
  <p>(StoreModel: function, iden: ?string, saveStore = true: boolean): <a href="/alt/docs/stores">AltStore</a></p>
</blockquote>

<p>This is a function that takes in a class of your store and returns back the singleton store. The second parameter <code>iden</code> is a string that is used as a unique identifier for serializing/deserializing your store. The name of the store comes from the class name but on production due to heavy minification it is a good idea to provide your own name to avoid collisions. The third parameter <code>saveStore</code> is to tell alt whether to save a reference to the store for later when using <a href="/alt/docs/bootstrap">bootstrap</a> or <a href="/alt/docs/takeSnapshot">snapshots</a>.</p>

<h1 id="storemodel">StoreModel</h1>

<h2 id="storemodelconstructor">StoreModel#constructor</h2>

<blockquote>
  <p>(alt: Alt): StoreModel</p>
</blockquote>

<p>The constructor of your store definition receieves the alt instance as its first and only argument. All instance variables, values assigned to <code>this</code>, in any part of the StoreModel will become part of state.</p>

<h2 id="storemodelon">StoreModel#on</h2>

<blockquote>
  <p>(lifecycleMethod: string, handler: function): undefined</p>
</blockquote>

<p>This method can be used to listen to <a href="/alt/docs/lifecycleListeners">Lifecycle events</a>. Normally they would be set up in the constructor.</p>

<pre><code class="language-js">class MyStore {
  constructor() {
    this.on('bootstrap', () =&gt; {
    });
  }
}
</code></pre>

<h2 id="storemodelbindaction">StoreModel#bindAction</h2>

<blockquote>
  <p>(actionsSymbol: symbol, storeHandler: function): undefined</p>
</blockquote>

<p>This method takes in an <a href="/alt/docs/actions#actionconstant">action’s symbol</a> and a store’s method defined in your StoreModel class. The store’s method is then bound to that action so whenever the action <a href="/alt/docs/createActions#actionsclassdispatch">dispatches</a> a payload, the specified handler will receive it.</p>

<pre><code class="language-js">class MyStore {
  constructor() {
    this.bindAction(MyActions.FOO, this.handleFoo);
  }

  handleFoo(data) {
    // do something with data
  }
}
</code></pre>

<h2 id="storemodelbindactions">StoreModel#bindActions</h2>

<blockquote>
  <p>(actions: object): undefined</p>
</blockquote>

<p>This is a magic method which takes in an object of action symbols and binds them to their specially named handlers which are defined in the StoreModel. An action with the name <code>foo</code> will match an action handler method defined in the StoreModel named <code>onFoo</code> or just <code>foo</code> but not both.</p>

<pre><code class="language-js">class MyStore {
  constructor() {
    this.bindActions(MyActions);
  }

  onFoo(data) {
    // do something with data
  }
}
</code></pre>

<h2 id="storemodelbindlisteners">StoreModel#bindListeners</h2>

<blockquote>
  <p>(listenersMap: object): undefined</p>
</blockquote>

<p><code>bindListeners</code> is the inversion of <code>bindAction</code> but in a much more convenient way. With this method you can exercise precise control over which actions you wish your store listens to and what handlers those actions are bound to. <code>bindListeners</code> accepts an object where the keys correspond to the method in your StoreModel and the values can either be an array of <a href="/alt/docs/actions#actionconstant">action symbols</a> or a single <a href="/alt/docs/actions#actionconstant">action symbol</a>.</p>

<pre><code class="language-js">class MyStore {
  constructor() {
    this.bindListeners({
      handleFoo: MyActions.FOO,
      handleBar: [MyActions.BAR, OtherActions.BAR]
    });
  }

  handleFoo(data) {
    // will only be called by MyActions.foo()
  }

  handleBar(data) {
    // will be called by MyActions.bar() and OtherActions.bar()
  }
}
</code></pre>

<h2 id="storemodelwaitfor">StoreModel#waitFor</h2>

<blockquote>
  <p>(dispatcherSource: mixed): undefined</p>
</blockquote>

<p><code>dispatcherSource</code> can be either a single token/source or an array of tokens/sources. <code>waitFor</code> is mostly an alias for the flux dispatcher’s waitFor method. This method is used to enable dependencies between stores and signal to the dispatcher that this store needs to wait for another store to update first before it can be updated itself.</p>

<pre><code class="language-js">class MyStore {
  onFoo(data) {

    // All of these do the same thing:
    this.waitFor(OtherStore);
    this.waitFor(OtherStore.dispatchToken);

    // You can also pass in multiple stores, these are all the same:
    this.waitFor([Store1, Store2]);
    this.waitFor([Store1.dispatchToken, Store2.dispatchToken]);
    this.waitFor(Store1, Store2);
    this.waitFor(Store1.dispatchToken, Store2.dispatchToken);

    // handle data once OtherStore is updated
  }
}
</code></pre>

<h2 id="storemodelexportpublicmethods">StoreModel#exportPublicMethods</h2>

<blockquote>
  <p>(methods: object): undefined</p>
</blockquote>

<p><code>exportPublicMethods</code> is an explicit, less magical alternative to declaring public methods as type <code>static</code>. The method accepts an object where the keys correspond to a method that exists inside or outside the StoreModel object.</p>

<pre><code class="language-js">const externalFunc = () =&gt; {
  // do something
};

class StoreBase {
  baseMethod() {
    // do something
  }
}

class Store extends StoreBase {
  constructor() {
    this.exportPublicMethods({
      baseMethod: this.baseMethod,
      ownMethod: this.ownMethod,
      externalFunc: externalFunc
    });
  }

  ownMethod() {
    // do something
  }
}
</code></pre>

<h2 id="storemodelgetinstance">StoreModel#getInstance</h2>

<blockquote>
  <p>(): (AltStore)[stores.md]</p>
</blockquote>

<p>This method retrieves the store instance which contains other methods like <code>getEventEmitter()</code>, <code>getState()</code>, and <code>emitChange()</code>.</p>

<pre><code class="language-js">class MyStore {
  handleFoo() {

    setTimeout(() =&gt; {
      // emit change later via the store instance.
      this.getInstance().emitChange();
    }, 100);

    // supress emitting a change.
    return false;
  }
}
</code></pre>

<h2 id="storemodelemitchange">StoreModel#emitChange</h2>

<blockquote>
  <p>(): undefined</p>
</blockquote>

<p>Shorthand for emitting a change from within a store.</p>

<pre><code class="language-js">class MyStore {
  handleFoo() {
    setTimeout(() =&gt; {
      this.emitChange();
    }, 100);

    // supress emitting a change.
    return false;
  }
}
</code></pre>

<h2 id="storemodelsetstate">StoreModel#setState</h2>

<blockquote>
  <p>(state = {}: object): false</p>
</blockquote>

<p><code>setState</code> is syntactic sugar for setting state. This method automatically emits a change event. This can be particularly useful when performing async in your stores when you wish to update the state and emit a change event all in one.</p>

<pre><code class="language-js">class MyStore {
  handleFoo() {
    this.foo = 0;

    setTimeout(() =&gt; {
      // set foo to 1 and emit a change.
      this.setState({
        foo: 1
      });
    }, 100);

    // supress emitting a change.
    return false;
  }
}
</code></pre>

<h2 id="storemodeldispatcher">StoreModel#dispatcher</h2>

<p>This is a reference to the dispatcher used by alt which is flux’s own dispatcher. You may use this to listen in on all the global dispatches yourself.</p>

<pre><code class="language-js">this.dispatcher.register(function (payload) {
  console.log(payload);
});
</code></pre>

<h2 id="storemodelalt">StoreModel#alt</h2>

<p>This is a reference to the alt instance. It can be used for getting other stores, dispatching, recycling, flushing, bootstrapping, snapshotting, etc. If you’re using alt stores as <a href="/alt/docs/altInstances">instances</a> rather than singletons then this property is very useful.</p>

<pre><code class="language-js">class MyStore {
  constructor() {
    var actions = this.alt.getActions('MyActions');
  }
}
</code></pre>

<h2 id="storemodelstorename">StoreModel#_storeName</h2>

<p>This is a reference to the store’s internal name. This is either the identifier you provided to <code>createStore</code> or StoreModel’s class name.</p>

<h2 id="storemodelbeforeeach">StoreModel#beforeEach</h2>

<blockquote>
  <p>(action: string, data: mixed, state: object): undefined</p>
</blockquote>

<p>This method gets called, if defined, before the payload hits the action. You can use this method to <code>waitFor</code> other stores, save previous state, or perform any bookeeping. The state passed in to <code>beforeEach</code> is the current state pre-action.</p>

<h2 id="storemodelaftereach">StoreModel#afterEach</h2>

<blockquote>
  <p>(action: string, data: mixed, state: object): undefined</p>
</blockquote>

<p>This method gets called, if defined, after the payload hits the action and the store emits a change. You can use this method for bookeeping and as a companion to <code>beforeEach</code>. The state passed in to <code>afterEach</code> is the current state post-action.</p>

          </div>
        </div>
      </div>
    </div>

    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/prism/0.0.1/prism.min.js"></script>
<script type="text/javascript">
  // Alias for javascript so syntax highlighting works fine
  Prism.languages.js = Prism.languages.javascript;
</script>
<footer class="sp-vert-md">
  <a href="https://www.npmjs.com/package/alt"><img src="https://img.shields.io/npm/v/alt.png?style=flat-square" alt="npm version" /></a>
  <a href="https://gitter.im/goatslacker/alt"><img src="https://img.shields.io/badge/gitter-join%20chat-ff7d29.svg?style=flat-square" alt="Gitter Chat" /></a>
</footer>


  </body>

</html>
